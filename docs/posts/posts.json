[
  {
    "path": "posts/2021-03-15-richness/",
    "title": "Cetacean Species Richness Map",
    "description": "A raster of species richness of cetacean species off the coast of California (in the California Bight) based on predicted range maps from Aquamaps.",
    "author": [
      {
        "name": "Erin Ristig",
        "url": {}
      }
    ],
    "date": "2021-02-15",
    "categories": [],
    "contents": "\n\n\nShow code\n\n# Read in libraries\nlibrary(raster)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(sf)\nlibrary(fasterize)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(ggsn)\nlibrary(ggplot2)\nlibrary(ggspatial)\n\n\n\nData source: Kaschner, K., Rius-Barile, J., Kesner-Reyes, K., Garilao, C., Kullander, S., Rees, T., & Froese, R. (2016). AquaMaps: Predicted range maps for aquatic species. www.aquamaps.org\n\nSpecies Richness Raster Map\n\n\nShow code\n\n# Create raster map\nggplot() +\n  geom_raster(data = species_df, aes(x = x, y = y, fill = n)) +\n  geom_sf(data = world) +\n  coord_sf(expand = 0, xlim = c(-125, -115), ylim = c(32, 38)) +\n  scale_fill_gradient(low = 'white', high = 'slateblue4') +\n  theme_void() +\n  theme(panel.background = element_rect(fill = 'slateblue4')) +\n  labs(title = \"Species Presence in the California Bight\",\n       subtitle = \"35 Cetacean Species\",\n       fill = \"Number of Species\") +\n  annotation_north_arrow(aes(location = \"br\")) +\n  annotation_scale(aes(location = \"tr\"))\n\n\n\n\nFigure 1: Presence raster of 35 cetacean species in the California Bight. Species richness determined using AquaMaps occurrence data. Threshold value to classify a species as ‘present’ set at 0.6.\n\n\n\n\n\n\n",
    "preview": "posts/2021-03-15-richness/richness_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-03-15T00:52:00-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-02-09-welcome/",
    "title": "A Spatial Prioritization Analysis for Shark and Ray Protection in Mozambique",
    "description": "Master's Thesis Group Project",
    "author": [
      {
        "name": "Erin Ristig",
        "url": {}
      }
    ],
    "date": "2021-02-09",
    "categories": [],
    "contents": "\nLearn more about the group project I have been working on for my Master’s thesis here: https://www.future4fins.com/\nOur project aims to improve shark and conservation policies in Mozambique through science-based recommendations. We will conduct a spatial prioritization analysis that takes into consideration the distribution, conservation status, critical habitat, and fishing pressure of elasmobranchs to provide marine protected area recommendations. In addition, we will consolidate a list of binding requirements and voluntary commitments that are imposed by International Conventions to help evaluate how well these are being met.\nThe results of this project will contribute to the broader marine conservation work being done by WCS and the Mozambique, Madagascar, Kenyan and Tanzanian governments to develop national policy for sharks and rays.\nHere are two example maps showing some of the conservation features used in the prioritization analysis:\nFigure 1. Conservation features: (a) species distribution for four of the focal species including Pristis pristis, Mobula kuhlii, Sypherma lewini, and Carcharhinus longimanus, and (b) five critical habitats including coral, seagrass, mangroves, seamounts, and knolls.\n\n\n",
    "preview": {},
    "last_modified": "2021-03-15T00:50:40-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-02-02-kaupulehu/",
    "title": "Size limit analysis of reef fishes at Ka‘ūpūlehu Marine Reserve",
    "description": "Report prepared for the Nature Conservancy and for Ka‘ūpūlehu Marine Life Advisory Committee",
    "author": [
      {
        "name": "Erin Ristig",
        "url": {}
      }
    ],
    "date": "2021-02-02",
    "categories": [],
    "contents": "\nThis report contains an analysis of size limit options for 33 reef-associated fish species that was conducted in support of continued development of management measures at Ka‘ūpūlehu Marine Reserve, Hawaiʻi Island. This work is provided for consideration by Ka‘ūpūlehu Marine Life Advisory Committee (KMLAC) in support of development of a long-term sustainable fishery at Ka‘ūpūlehu and Kūki‘o on Hawaiʻi Island. Through a previous series of workshops coordinated by KMLAC and The Nature Conservancy, size limits were identified as one of several priority management options.\nIn this report, the effects of species-specific size limits are analyzed in terms of optimization of fishing yield and protection of spawning biomass. This analysis is constructed from the perspective that reaching spawning size prior to becoming vulnerable to fishing is a relevant consideration for ensuring long-term sustainability of fish populations. Thus, size limit options are explored relative to size at maturity. Accordingly, the analysis is intended to guide decision-making in relation to yield and spawning biomass objectives, and to support on-going community-led discussions about preference, feasibility, and pragmatism of size limits as management measures within the Kaʻūpūlehu Comprehensive Management Plan.\nFull Report\n\n Example Code  \n Spawning Potential Ratio and Yield per Recruit Analyses \n\n\n\nShow code\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(LBSPR)\nlibrary(dplyr)\nlibrary(kableExtra)\nlibrary(ggalt)\nlibrary(ggrepel)\nlibrary(knitr)\nlibrary(directlabels)\nlibrary(gridExtra)\nlibrary(ggplot2)\nlibrary(viridis)\nlibrary(RColorBrewer)\n\n# Read in CSV\nspecies <- read_csv(\"Final_Species_List.csv\")\n\n\n\n\n\nShow code\n\n## LBSPR function\n\nlh_function <- function(row) {\n  # Create a new LB_pars object for each species\n  MyPars <- new(\"LB_pars\")\n  MyPars@Species<-row['species']\n  MyPars@Linf <- as.numeric(row['Linf'])\n  MyPars@L50 <- as.numeric(row['L50'])\n  MyPars@L95 <- as.numeric(row['L95'])\n  MyPars@MK <- as.numeric(row['M/K'])\n  MyPars@BinWidth <- as.numeric(row['BinWidth'])\n  MyPars@Steepness<-0.99\n  MyPars@L_units <- \"mm\"\n  MyPars@Walpha <- as.numeric(row['LW_A'])\n  MyPars@Walpha_units <- \"g\"\n  MyPars@Wbeta <- as.numeric(row['LW_B'])\n  MyPars@FecB <- as.numeric(row['LW_B'])\n  MyPars@BinMin <- 0\n  #Setup place holder values for these parameters, we will change these later\n  MyPars@SL50 <- as.numeric(row['SL50'])\n  MyPars@SL95 <- as.numeric(row['SL95'])\n  MyPars@FM<-1\n \n  return(list(MyPars=MyPars, CurrentLc=as.numeric(row['CurrentLc_mm'])))\n}\n\n\n\n\n\nShow code\n\n## YPR Function\nypr_function<-function(MyParsList, SL_options, FM_options){\n  rw<-NROW(MyParsList)\n  YPR<-list()\n  SPR<-list()\n  EU<-list()\n  \n  for (k in 1:rw){\n    \n    YPR[[k]]<-data.frame()\n    SPR[[k]]<-data.frame()\n    EU[[k]]<-list()\n    \n    # SL filtering\n    if(!is.na(MyParsList[[k]]$CurrentLc)) {\n      SL_tmp<-round(c(SL_options*MyParsList[[k]]$MyPars@L50, MyParsList[[k]]$CurrentLc),0)\n      SL_names<-c(paste0(SL_options, \" x Lm\"), \"Current size limit\")\n    }\n    if(is.na(MyParsList[[k]]$CurrentLc)) {\n      SL_tmp<-round(SL_options*MyParsList[[k]]$MyPars@L50,0)\n      SL_names<-paste0(SL_options, \" x Lm\")\n    }\n    Keep<-c(SL_tmp < 0.95*MyParsList[[k]]$MyPars@Linf)\n    SL_options_mult<-SL_options[Keep]\n    SL_options_mm<-SL_tmp[Keep]\n    SL_names<-SL_names[Keep]\n    SL_options_inch <- round(SL_options_mm/25.4,1)\n    \n    #Loop over FM options\n    for (i in 1:NROW(FM_options)){\n      tmpYPR<-data.frame()\n      tmpSPR<-data.frame()\n      #loop over Lc options\n      for (j in 1:NROW(SL_options_mm)){\n        tmpPars<-MyParsList[[k]]$MyPars\n        tmpPars@FM<-FM_options[i]\n        tmpPars@SL50 <- SL_options_mm[j]\n        tmpPars@SL95 <- SL_options_mm[j]+1\n        tmpSim <- LBSPRsim(tmpPars, verbose=FALSE)\n        tmpYPR<-rbind(tmpYPR, list(Name=SL_names[j], Lc_mm=SL_options_mm[j], Lc_inch=SL_options_inch[j], Lc_Linf=SL_options_mm[j]/MyParsList[[k]]$MyPars@Linf, FM=FM_options[i], YPR=tmpSim@YPR))\n        tmpSPR<-rbind(tmpSPR, list(Name=SL_names[j], Lc_mm=SL_options_mm[j], Lc_inch=SL_options_inch[j], FM=FM_options[i], SPR=tmpSim@SPR))\n      }\n      #Save to master list\n      YPR[[k]]<-rbind(YPR[[k]], tmpYPR)\n      SPR[[k]]<-rbind(SPR[[k]], tmpSPR)\n    }\n    YPR[[k]]$YPR<-YPR[[k]]$YPR/max(YPR[[k]]$YPR)\n    \n    #Eumetric analysis\n    Lc<-seq(0.1*MyParsList[[k]]$MyPars@L50,0.95*MyParsList[[k]]$MyPars@Linf,5)\n    F_M<-seq(0, 4, 0.1)\n    \n      #x = seq(0, 1, length.out = nrow(z)),\n      #y = seq(0, 1, length.out = ncol(z)),\n      #z\n    \n    SPR_EU<-matrix(nrow=NROW(F_M), ncol=NROW(Lc))\n    YPR_EU<-matrix(nrow=NROW(F_M), ncol=NROW(Lc))\n    for (i in 1:NROW(F_M)){\n      for (j in 1:NROW(Lc)){\n        tmpPars<-MyParsList[[k]]$MyPars\n        tmpPars@FM<-F_M[i]\n        tmpPars@SL50 <- Lc[j]\n        tmpPars@SL95 <-Lc[j]+1\n        tmpSim <- LBSPRsim(tmpPars, verbose=FALSE)\n        SPR_EU[i,j]=tmpSim@SPR\n        YPR_EU[i,j]=tmpSim@YPR\n      }\n    }\n    x<-which(YPR_EU==max(YPR_EU), arr.ind=TRUE)\n    YPR_EU<-YPR_EU/YPR_EU[x[1],x[2]]\n    EU[[k]]$SPR_EU<-SPR_EU\n    EU[[k]]$YPR_EU<-YPR_EU\n    EU[[k]]$Lc<-Lc\n    EU[[k]]$F_M<-F_M\n    EU[[k]]$L50<-MyParsList[[k]]$MyPars@L50\n    \n  }\n  return(list(YPR=YPR, SPR=SPR, EU=EU))\n}\n\n\n\n\n\nShow code\n\n### Conduct analysis\n\n## Step 1. Set number of species to analyze\n\n# Run whole list\n#MyParsList_all<-apply(species, 1, lh_function)\n\n# Run for two species\n#MyParsList_two<-apply(species[13:14,], 1, lh_function)\n\n# Set option\n#MyParsList <- MyParsList_two\nMyParsList<-readRDS(\"MyParsList.rds\")\n\n\n## Step 2. Run SL & FM options\nSL_options<-c(0.9, 1, 1.1, 1.2, 1.3)\nFM_options<-c(1, 2, 3)\n\n## Step 3. Run analysis function ypr_function\n#output<-ypr_function(MyParsList, SL_options, FM_options) \noutput<-readRDS(\"output.rds\")\n\n\n\n\n Albulidae - Bonefishes \n\n\n\n\nShow code\n\n### Appendix\n\n# Text template for createText function\ntemplate <- \"#### Species: **%s**\n###### **Hawaiian Name:** %s\n###### **Common Name:** %s\n###### **Family:** %s\n###### **Current Minimum Size Limit:** %s \n##### Life History Parameters\n###### **L infinity (von Bertalanffy growth parameter):** %s millimeters\n###### **K (von Bertalanffy growth parameter):** %s year^-1\n###### **t0 (von Bertalanffy growth parameter):** %s\n###### **Length at maturity (inches):** %s inches\n###### **M (natural mortality rate):** %s year^-1\n###### **Longevity:** %s years\n\n\"\n# Text template function\ncreateText <- function(fish) {\n  \n  text <- cat(sprintf(template, fish$species, fish$hawaii_name, fish$common_name, fish$common_family, fish$CurrentLc_in_label, fish$Linf, fish$K, fish$t0, fish$Lm_in, fish$M, fish$LONG))\n\n  return(text)\n}\n\n###################################################\n### Full function to create 2 tables and 4 charts\n\n for (k in 1:2){\n\n   # Text for each species\n   one_species <- species %>% \n     filter(species == MyParsList[[k]]$MyPars@Species)\n   \n   cat(createText(one_species))\n\n######################################################\n### Tables\n   \n  # SPR Table\n  SPR<-output$SPR[[k]]\n  SPR_wide<-SPR %>% \n    pivot_wider(id_cols=c(Name, Lc_mm, Lc_inch), names_from = FM, values_from = SPR)\n  options(knitr.kable.NA = \"\")\n  colnames(SPR_wide)<-c(\"Option\", \"mm\", \"inches\", \"Low\", \"Med\", \"High\")\n  nameSPR<-c(NCOL(SPR_wide))\n  names(nameSPR) <- c(paste0(MyParsList[[k]]$MyPars@Species, \" - SPR Values\"))\n  namesSub<-c(1,2,(NCOL(SPR_wide)-3))\n  \n  print(kable(SPR_wide, align = \"llcccc\", digits = 3, caption = names(nameSPR)) %>% \n    kable_styling(c(\"condensed\", \"responsive\", \"bordered\"),\n                bootstrap_options = \"striped\", \n                full_width = F,\n                position = \"float_left\"\n                  ) %>% \n    column_spec(4:6, bold = TRUE) %>% \n    add_header_above(c(\"Minimum Size Limit\" = 3, \"Fishing Pressure (F/M)\" = 3)) %>% \n    column_spec(4, border_left = T))\n  \n  # YPR Table\n  ypr_plot <- YPR<-output$YPR[[k]] \n  YPR_wide<-YPR %>% \n    pivot_wider(id_cols=c(Name, Lc_mm, Lc_inch), names_from = FM, values_from = YPR)\n  colnames(YPR_wide)<-c(\"Option\", \"mm\", \"inches\", \"Low\", \"Med\", \"High\")\n  options(knitr.kable.NA = \"\")\n  nameYPR<-c(NCOL(SPR_wide))\n  names(nameYPR)<-c(paste0(MyParsList[[k]]$MyPars@Species, \" - YPR Values\"))\n  namesSub<-c(1,2,(NCOL(SPR_wide)-3))\n\n  print(kable(YPR_wide, align = \"llcccc\", digits = 3, caption = names(nameYPR)) %>% \n    kable_styling(c(\"condensed\", \"responsive\", \"bordered\"), bootstrap_options = \"striped\", \n                full_width = F,\n                position = \"right\"\n                  ) %>% \n    column_spec(4:6, bold = TRUE) %>% \n    column_spec(4, border_left = T) %>% \n    add_header_above(c(\"Minimum Size Limit\" = 3, \"Fishing Pressure (F/M)\" = 3)))\n  \n######################################################  \n### Contour Plots\n  \n  EU_grid<-expand.grid(Lc=output$EU[[k]]$Lc/25.4,\n                       F_M=output$EU[[k]]$F_M)\n  EU_grid$ypr<-as.vector(t(output$EU[[k]]$YPR_EU))\n  EU_grid$spr<-as.vector(t(output$EU[[k]]$SPR_EU))\n  \n  # YPR Contour Plot\nypr_plot <- ggplot(EU_grid, aes(x=F_M, y=Lc, z=ypr)) + \n    geom_contour_filled(binwidth=0.1, alpha = 0.8) +\n  scale_fill_brewer(palette = \"RdYlGn\", labels =c(0, \" \", \" \", \" \", \" \", 0.5, \" \", \" \", \" \", \" \", 1)) +\n    geom_hline(yintercept =output$EU[[k]]$L50/25.4, linetype=\"dashed\", \n                  color = \"black\", size=0.7) +\n  geom_text(size = 3.5, aes(3.1,output$EU[[k]]$L50/25.4,label = \"Length at maturity\", vjust = -1)) +\n  theme_light() +\n    labs(y=\"Length at Capture (inches)\", x = \"Relative Fishing Pressure (F/M)\", title = names(nameYPR))+\n    guides(fill=guide_bins(\n      title = \"YPR Value\",\n      direction = \"horizontal\",\n      title.position = \"left\",\n      title.vjust = 0.9,\n      label.position = \"bottom\",\n      show.limits = TRUE,\n      axis = FALSE,\n      keywidth = unit(5.5, \"mm\"))) +\n    theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n      panel.background = element_blank(), axis.line = element_line(colour = \"black\"),\n      legend.position = \"bottom\") +\nscale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0))\n  \n# SPR Contour Plot\nspr_plot <- ggplot(EU_grid, aes(x=F_M, y=Lc, z=spr)) + \n    geom_contour_filled(binwidth=0.1, alpha = 0.8) +\n  scale_fill_brewer(palette = \"RdYlGn\", labels =c(0, \" \", \" \", \" \", \" \", 0.5, \" \", \" \", \" \", \" \", 1)) +\n    geom_hline(yintercept =output$EU[[k]]$L50/25.4, linetype=\"dashed\", \n                  color = \"black\", size=0.7) +\n  geom_text(size = 3.5, aes(3.1,output$EU[[k]]$L50/25.4,label = \"Length at maturity\", vjust = -1)) +\n  theme_light() +\n    labs(y=\"Length at Capture (inches)\", x = \"Relative Fishing Pressure (F/M)\", title = names(nameSPR))+\n    guides(fill=guide_bins(\n      title = \"SPR Value\",\n      direction = \"horizontal\",\n      title.position = \"left\",\n      title.vjust = 0.9,\n      label.position = \"bottom\",\n      show.limits = TRUE,\n      axis = FALSE, \n      keywidth = unit(5.5, \"mm\"))) +\n    theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n      panel.background = element_blank(), axis.line = element_line(colour = \"black\"),\n      legend.position = \"bottom\") +\nscale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0))\n\n# Side by side contour plots\ngrid.arrange(spr_plot, ypr_plot, nrow = 1)\n\n##########################################\n### Pareto Plots\n\n  # Pareto plots prep\n  Flevel<-c(0,4)\n  EU_tmp<-EU_grid %>%\n            filter(F_M > Flevel[1],\n                   F_M < Flevel[2])\n  values<-c(0,\n            (output$EU[[k]]$L50/25.4-0.5)/max(EU_tmp$Lc)-0.01,\n            (output$EU[[k]]$L50/25.4-0.5)/max(EU_tmp$Lc),\n            (output$EU[[k]]$L50/25.4+0.5)/max(EU_tmp$Lc),\n            (output$EU[[k]]$L50/25.4+0.5)/max(EU_tmp$Lc)+0.01,\n            1)\n  colors<-c(\"#A50026\",\"#FDAE61\",\"black\",\"#A6D96A\",\"#006837\")\n  pareto_title_one <- c(paste0(MyParsList[[k]]$MyPars@Species))\n  pareto_subtitle_one <- c(paste0(\"SPR-YPR Tradeoffs\"))\n  pareto_title_two <- c(paste0(MyParsList[[k]]$MyPars@Species))\n  pareto_subtitle_two <- c(paste0(\"Size Limit-Fishing Pressure Combinations\"))\n  \n  # Pareto plot - gradient\n  print(ggplot(EU_tmp, aes(x=ypr, y=spr, colour=Lc)) +\n    geom_point(alpha = 0.6) +\n    scale_colour_gradientn(\n      name=\"Length at Capture (in)\",\n      colors=colors,\n      values=values) +\n    ylim(0,1) +\n    xlim(0,1) +\n    labs(y=\"Spawning Potential Ratio (SPR)\", x = \"Relative Yield per Recruit (YPR)\", title = pareto_title_one, subtitle = pareto_subtitle_one) +\n    theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n      panel.background = element_blank(), axis.line = element_line(colour = \"black\"),\n      legend.position = \"right\")) +\n    theme_light()\n  \n  # Pareto point plot prep\n  dt=data.frame(YPR=output$YPR[[k]]$YPR[output$YPR[[k]]$Name != \"Current size limit\"],\n                SPR=output$SPR[[k]]$SPR[output$SPR[[k]]$Name != \"Current size limit\"],\n                Lc= output$SPR[[k]]$Lc_inch[output$SPR[[k]]$Name != \"Current size limit\"],\n                F_M=factor(output$SPR[[k]]$FM[output$SPR[[k]]$Name != \"Current size limit\"],labels=c(\"L\", \"M\", \"H\")))\n  \n  # Pareto Point Plot\n  print(ggplot() +\n  geom_point(data=EU_tmp, aes(x=ypr, y=spr), colour=\"lightgrey\", alpha=0.1) +\n  geom_point(data=dt, aes(x=YPR, y=SPR, colour=Lc)) +\n  scale_colour_gradientn(\n    name=\"Length at Capture (in)\",\n    colors=colors,\n    values=values,\n    limits=c(min(EU_tmp$Lc), max(EU_tmp$Lc))) +\n  geom_label_repel(data=dt, aes(x=YPR, y=SPR, colour=Lc, label = paste0(Lc,F_M)), segment.color = 'black') +\n  annotate(geom=\"text\", x=0.75, y=0.9, label=paste0(\"Length at Maturity: \", round(output$EU[[k]]$L50/25.4,1), \" inches\")) +\n  labs(y=\"Spawning Potential Ratio (SPR)\", x = \"Relative Yield per Recruit (YPR)\", title = pareto_title_two, subtitle = pareto_subtitle_two)+\n  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n    panel.background = element_blank(), axis.line = element_line(colour = \"black\"),\n    legend.position = \"right\")) +\n    theme_light()\n\ncat(\"  \\n\")\ncat(\"  \\n\")\ncat(\"  \\n\")\n\n}\n\n\n\nTable 1: Acanthurus blochii - SPR Values\n\n\n\nMinimum Size Limit\n\n\n\n\nFishing Pressure (F/M)\n\n\n\nOption\n\n\nmm\n\n\ninches\n\n\nLow\n\n\nMed\n\n\nHigh\n\n\n0.9 x Lm\n\n\n231\n\n\n9.1\n\n\n0.405\n\n\n0.228\n\n\n0.105\n\n\n1 x Lm\n\n\n257\n\n\n10.1\n\n\n0.451\n\n\n0.283\n\n\n0.161\n\n\n1.1 x Lm\n\n\n283\n\n\n11.1\n\n\n0.534\n\n\n0.387\n\n\n0.277\n\n\n1.2 x Lm\n\n\n308\n\n\n12.1\n\n\n0.648\n\n\n0.535\n\n\n0.447\n\n\nTable 1: Acanthurus blochii - YPR Values\n\n\n\nMinimum Size Limit\n\n\n\n\nFishing Pressure (F/M)\n\n\n\nOption\n\n\nmm\n\n\ninches\n\n\nLow\n\n\nMed\n\n\nHigh\n\n\n0.9 x Lm\n\n\n231\n\n\n9.1\n\n\n0.672\n\n\n0.809\n\n\n0.858\n\n\n1 x Lm\n\n\n257\n\n\n10.1\n\n\n0.667\n\n\n0.830\n\n\n0.925\n\n\n1.1 x Lm\n\n\n283\n\n\n11.1\n\n\n0.625\n\n\n0.813\n\n\n0.966\n\n\n1.2 x Lm\n\n\n308\n\n\n12.1\n\n\n0.523\n\n\n0.709\n\n\n0.894\n\n\n\nTable 1: Acanthurus dussumieri - SPR Values\n\n\n\nMinimum Size Limit\n\n\n\n\nFishing Pressure (F/M)\n\n\n\nOption\n\n\nmm\n\n\ninches\n\n\nLow\n\n\nMed\n\n\nHigh\n\n\n0.9 x Lm\n\n\n254\n\n\n10.0\n\n\n0.405\n\n\n0.229\n\n\n0.107\n\n\n1 x Lm\n\n\n282\n\n\n11.1\n\n\n0.450\n\n\n0.282\n\n\n0.160\n\n\n1.1 x Lm\n\n\n310\n\n\n12.2\n\n\n0.529\n\n\n0.381\n\n\n0.270\n\n\n1.2 x Lm\n\n\n338\n\n\n13.3\n\n\n0.649\n\n\n0.536\n\n\n0.448\n\n\nTable 1: Acanthurus dussumieri - YPR Values\n\n\n\nMinimum Size Limit\n\n\n\n\nFishing Pressure (F/M)\n\n\n\nOption\n\n\nmm\n\n\ninches\n\n\nLow\n\n\nMed\n\n\nHigh\n\n\n0.9 x Lm\n\n\n254\n\n\n10.0\n\n\n0.698\n\n\n0.841\n\n\n0.893\n\n\n1 x Lm\n\n\n282\n\n\n11.1\n\n\n0.691\n\n\n0.858\n\n\n0.953\n\n\n1.1 x Lm\n\n\n310\n\n\n12.2\n\n\n0.656\n\n\n0.853\n\n\n1.000\n\n\n1.2 x Lm\n\n\n338\n\n\n13.3\n\n\n0.538\n\n\n0.725\n\n\n0.906\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "preview": "posts/2021-02-02-kaupulehu/kaupulehu_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2021-03-15T00:36:36-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-14-lobster/",
    "title": "Spiny Lobster Abundance",
    "description": "A report looking at California Spiny Lobster (Panulirus interruptus) abundance and size along the Santa Barbara coast from 2012 - 2018.",
    "author": [
      {
        "name": "Erin Ristig",
        "url": {}
      }
    ],
    "date": "2021-01-21",
    "categories": [],
    "contents": "\n\n\nShow code\n\n# Attach packages\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(here)\nlibrary(janitor)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(effsize)\nlibrary(kableExtra)\nlibrary(plotly)\nlibrary(directlabels)\n\n\n\n\n\nShow code\n\n# Read in data, tidy, and save it as a CSV.\n\nlobster_clean <- read_csv(here::here(\"_posts\", \"2021-03-14-lobster\", \"raw_data\", \"lobster_abundance_sbc_lter.csv\"), na = \"-99999\") %>% \n  clean_names() %>% \n  mutate(date = ymd(date)) %>% \n  mutate(day = day(date)) %>% \n  select(-date)\n    \nwrite_csv(lobster_clean, \"lobster_clean.csv\")\n\n\n\n\nCalifornia Spiny Lobster abundance and size in five California reefs\nINTRODUCTION\nThis report looks at California Spiny Lobster (Panulirus interruptus, Figure 1) abundance and size along the Santa Barbara coast from 2012 - 2018. The spiny lobster is found in giant kelp forests in Southern California and is an important predator in these ecosystems. Spiny lobsters are also a prized target for both commercial and recreational fishermen and divers in the area. The data for this report comes from five long term kelp forest study sites along the mainland coast of the Santa Barbara Channel. Two of these sites are within Marine Protected Areas (MPAs) that were established on January 1, 2012; the other three sites are not within MPAs. It is prohibited to take spiny lobsters within the two marine protected areas - Naples Reef and Isla Vista Reef. By looking at time-series data over a seven year period, we will analyze if and how lobster abundance and size changed over time within MPAs as compared to reefs that are not protected.\n\nFigure 1. A California Spiny Lobster (Source: National Park Service)\nDATA AND METHODS\nThe data comes from Santa Barbara Long-Term Ecological Research (LTER), a research program based at the University of California, Santa Barbara Marine Science Institute. Data was collected beginning in 2012 by divers within five long term kelp forest study sites (Figure 2). Sampling on lobster size and abundance was taken annually in late summer prior to the start of fishing season at Naples, Isla Vista, Arroyo Quemado, Mohawk, and Carpinteria reefs. The variables studied in this report are lobster size, abundance, and protected status. Non-paired t-tests were performed, with an alpha of 0.025 used to indicate statistical significance; Cohen’s d was calculated to measure effect size. The software used for this analysis was RStudio Version 1.2.1335.\n\nFigure 2. Spatial distribution of sampling areas\nRESULTS A: Lobster abundance over time.\n\n\n\nShow code\n\n# Going to create a summary table that lists total lobsters per year per site   \n\nlobster_year <- lobster_clean %>% \n  mutate(total_lobsters = count + num_ao) %>% \n  group_by(year, site) %>% \n  summarize(total_lobsters = sum(total_lobsters))\n\n# Rename sites within data set\nlobster_year$site[lobster_year$site == \"AQUE\"] <- \"Arroyo Quemado\"\nlobster_year$site[lobster_year$site == \"CARP\"] <- \"Carpinteria\"\nlobster_year$site[lobster_year$site == \"NAPL\"] <- \"Naples (MPA)\"\nlobster_year$site[lobster_year$site == \"IVEE\"] <- \"Isla Vista (MPA)\"\nlobster_year$site[lobster_year$site == \"MOHK\"] <- \"Mohawk\"\n\n#____________________________\n# Graph it!\n\nggplot(data = lobster_year, aes(x = year, y = total_lobsters)) +\n         geom_line(aes(color = site), show.legend = FALSE) +\n  labs(x = \"Year\",\n       y = \"Lobster Count\",\n       title = \"California Spiny Lobster abundance at five sites\n       along the Santa Barbara Channel coastline\",\n       subtitle = \"2012 - 2018\") +\n  theme_light() +\n  theme(plot.title = element_text(size = rel(1.5), \n                                  hjust = 0.5, \n                                  lineheight = 0.9),\n        plot.subtitle = element_text(size = rel(1.2), \n                                    hjust = 0.5)) +\n  scale_x_continuous(lim = c(2012, 2019.5), expand = c(0, 0)) +\n  scale_y_continuous(lim = c(0, 1000), expand = c(0, 0)) +\n  # Direct labels to label the lines instead of a legend\n  geom_dl(aes(label = site), method = list(\"last.points\", cex = .65, hjust = -.17)) +\n  # Change colors of the lines \n  scale_color_manual(values = c(\"lightcoral\", \"gold3\", \"steelblue1\", \"mediumorchid\", \"darkturquoise\"))\n\n\n\n\nFigure 3. California Spiny Lobster count from 2012 to 2018 at two MPA sites (Isla Vista and Naples) and three non-MPA sites (Mohawk, Carpinteria, and Arroyo Quemado).\nIn 2012, lobster abundance was similar across all five sites. (Figure 3). At the two MPA reefs, there was a general upward trend of lobster abundance from 2012-2018. Lobster abundance at Isla Vista Reef showed the greatest increase over time.\n\nRESULTS B: Lobster size distributions in 2012 and 2018.\n\n\n\nShow code\n\nlobster_tidy_data <- read_csv(here::here(\"_posts\", \"2021-03-14-lobster\", \"clean_data\", \"lobster_clean.csv\"))\n\n# This is not quite in tidy format. SOme rows store multiple observations. I need to separate those, so that every row contains a distinct observation. I'll also take this opportunity to narrow down to my variables of interest.\n\nlobster_tidier_data <- lobster_tidy_data %>%\n  filter(year == \"2012\"|year == \"2018\") %>% \n  select(year, site, size_mm, count) %>% \n  uncount(count)\n\n# Okay. Now, I want to find the average lobster size for each site by year.\n\nsize_averages <- lobster_tidier_data %>% \n  group_by(site, year) %>% \n  summarize(avg_size = mean(size_mm))\n\n# Now, to graph:\n\nggplot() +\n  labs(x = \"Site\",\n       y = \"Lobster length in millimeters\",\n       title = \n       \"California Spiny Lobster size at five sites\nalong the Santa Barbara Channel coastline\",\n       subtitle = \"2012 and 2018\"\n       ) +\n  theme(panel.grid.major  = element_line(color = \"transparent\"),\n        panel.background = element_rect(fill = \"white\"),\n        axis.line = element_line(size = 1,\n                                  color = \"#978B7D\"),\n        panel.grid.minor.y = element_blank(),\n        axis.title = element_text(size = rel(1.1)),\n        plot.title = element_text(size = rel(1.5), \n                                  hjust = 0.5, \n                                  lineheight = 0.9),\n        plot.subtitle = element_text(size = rel(1.2), \n                                    hjust = 0.5),\n        legend.position = c(.99, .95),\n        legend.justification = c(\"right\", \"top\"),\n        legend.title = element_blank(),\n        legend.text = element_text(size = rel(1.1)),\n        legend.key = element_rect(fill = \"white\"),\n        legend.key.size = unit(2, \"line\")\n  ) +\n  geom_boxplot(\n    data = lobster_tidier_data,\n    aes(\n      x = site,\n      y = size_mm,\n      fill = factor(year)\n      ),\n    stat = \"boxplot\",\n    position= \"dodge\",\n    outlier.colour = \"#978B7D\",\n    color = \"#978B7D\"\n    ) +\n  scale_fill_manual(\n    values = c(\"#6EC5B8\", \"#DC5C05\")\n    ) +\n  scale_x_discrete(\n    limits = c('IVEE', 'NAPL', 'MOHK', 'CARP', 'AQUE'),\n    labels = c(\"Isla Vista (MPA)\", \"Naples (MPA)\", \"Mohawk\", \"Carpinteria\", \"Arroyo Quemado\"),\n    )\n\n\n\nShow code\n\n# Save in the figures folder\nggsave(here::here(\"_posts\", \"2021-03-14-lobster\", \"figures\", \"results_b.png\"))\n\n\n\n\nFigure 4. California Spiny Lobster size distribtions (in mm) in 2012 and 2018 at two MPA sites (Isla Vista and Naples) and three non-MPA sites (Mohawk, Carpinteria, and Arroyo Quemado).\nAt Naples and Isla Vista reefs, community size structure distributions shifted, with higher upper limits in 2018 (Figure 4). Distrubution of community size structure at Mohawk decreased over the time period.\n\nRESULTS C: Mean lobster size at MPA and non-MPA sites in 2012 and 2018.\n\n\n\nShow code\n\n# Set up a data frame to analyze the difference in means.\n\nlobster_stats_df <- lobster_tidy_data %>%\n  mutate(mpa = if_else(lobster_tidy_data$site %in% c(\"IVEE\", \"NAPL\"), \"mpa\", \"non-mpa\"))\n\nlobster_stats_df <- lobster_stats_df %>% \n  uncount(count)\n\n# Look at a QQ plot:\n\n# ggplot(lobster_stats_df, aes(sample = size_mm)) +\n#  geom_qq()\n\n# The data is distributed roughly normally, with some outliers on the leading tail.\n\n# ------------------------\n# Lobster size, 2012 and 2018\n# Summary statistics and analysis\n# -------------------\n\n# MPA:\nmpa_2012 <- lobster_stats_df %>% \n  filter(year == \"2012\") %>% \n  filter(mpa == \"mpa\")\n\nmpa_2018 <- lobster_stats_df %>% \n  filter(year == \"2018\") %>% \n  filter(mpa == \"mpa\")\n\n# non-MPA:\nnon_2012 <- lobster_stats_df %>% \n  filter(year == \"2012\") %>% \n  filter(mpa == \"non-mpa\")\n\nnon_2018 <- lobster_stats_df %>% \n  filter(year == \"2018\") %>% \n  filter(mpa == \"non-mpa\")\n\n# -------------------\n\n# Sample size (MPAs):\nn_mpa_12 <- sum(!is.na(mpa_2012$mpa))\nn_mpa_18 <- sum(!is.na(mpa_2018$mpa))\n\n# Sample size (non-MPAs):\nn_non_12 <- sum(!is.na(non_2012$mpa))\nn_non_18 <- sum(!is.na(non_2018$mpa))\n\n# -------------------\n\n# Means (2012, MPA and Non):\nmean_mpa_12 <- mean(mpa_2012$size_mm, na.rm = TRUE)\nmean_non_12 <- mean(non_2012$size_mm, na.rm = TRUE)\n\n# Means (2018, MPA and Non):\nmean_mpa_18 <- mean(mpa_2018$size_mm, na.rm = TRUE)\nmean_non_18 <- mean(non_2018$size_mm, na.rm = TRUE)\n\n# -------------------\n\n# Medians (2012, MPA and Non):\nmedian_mpa_12 <- median(mpa_2012$size_mm, na.rm = TRUE)\nmedian_non_12 <- median(non_2012$size_mm, na.rm = TRUE)\n\n# Medians (2018, MPA and Non):\nmedian_mpa_18 <- median(mpa_2018$size_mm, na.rm = TRUE)\nmedian_non_18 <- median(non_2018$size_mm, na.rm = TRUE)\n\n# -------------------\n\n# Standard deviations (2012, MPA and Non):\nsd_mpa_12 <- sd(mpa_2012$size_mm, na.rm = TRUE)\nsd_non_12 <- sd(non_2012$size_mm, na.rm = TRUE)\n\n# Standard deviations (2018, MPA and Non):\nsd_mpa_18 <- sd(mpa_2018$size_mm, na.rm = TRUE)\nsd_non_18 <- sd(non_2018$size_mm, na.rm = TRUE)\n\n# ------------------\n# Analysis\n# ------------------\n\n#### Are observations paired or unpaired? \n\n# 1.\n\n# Null hypothesis: The mean lobster size is the same in MPA and non-MPA sites for 2012 observations.\n\n# Alternative hypothesis: The mean lobster size is NOT the same in MPA and non-MPA sites for 2012 observations.\n\n# 2.\n\n# Null hypothesis: The mean lobster size is the same in MPA and non-MPA sites for 2018 observations.\n\n# Alternative hypothesis: The mean lobster size is NOT the same in MPA and non-MPA sites for 2018 observations.\n\n# When comparing MPA and non-MPA sites, our observations were grouped. We are not comparing transects at each reef, because lobsters move. The transects are a relative measurement, and don't tell us anything about lobster distribution across reefs.\n\n# We're not comparing individual lobsters over time. So, our t-test will be unpaired.\n\nsize_test_2012 <- t.test(mpa_2012$size_mm, non_2012$size_mm, paired = FALSE)\n\nsize_test_2018 <- t.test(mpa_2018$size_mm, non_2018$size_mm, paired = FALSE)\n\n# -----------------\n# Effect size (1 and 2)\n# -----------------\n\n# 2012 samples\nd_2012 <- effsize::cohen.d(non_2012$size_mm, mpa_2012$size_mm, na.rm = TRUE)\nd_2012\n\n\n\nCohen's d\n\nd estimate: 0.6098605 (medium)\n95 percent confidence interval:\n    lower     upper \n0.2304404 0.9892805 \n\nShow code\n\n# We have a moderate effect size for 2012 (d = 0.6).\n\n# 2018 samples\nd_2018 <- effsize::cohen.d(non_2018$size_mm, mpa_2018$size_mm, na.rm = TRUE)\nd_2018\n\n\n\nCohen's d\n\nd estimate: -0.3514986 (small)\n95 percent confidence interval:\n     lower      upper \n-0.4519004 -0.2510969 \n\nShow code\n\n# We have a small effect size for 2018 (d = 0.3).\n\n# THIS MEANS:\n# The size differences between the lobsters was statistically significant in 2012 and 2018 (p < 0.05). But, in 2012, the difference between mean lobster size at MPA and non-MPA reefs was larger (-7.5 mm) than in 2018 (4.0 mm). \n\n# We also looked at the confidence intervals and absolute differences in means.\n\ndifference_2012 <- mean_mpa_12 - mean_non_12\n\ndifference_2018 <- mean_mpa_18 - mean_non_18\n\n# ---------------\n# Mean size at MPA 2012 - 2018 (3)\n# ---------------\n\nsize_test_mpa <- t.test(mpa_2012$size_mm, mpa_2018$size_mm, paired = FALSE)\nsize_test_mpa\n\n\n\n    Welch Two Sample t-test\n\ndata:  mpa_2012$size_mm and mpa_2018$size_mm\nt = -4.6879, df = 32.496, p-value = 4.76e-05\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -14.617486  -5.765954\nsample estimates:\nmean of x mean of y \n 67.37500  77.56672 \n\nShow code\n\n# ---------------\n# Mean size at non-MPA 2012 - 2018 (4)\n# ---------------\n\nsize_test_non <- t.test(non_2012$size_mm, non_2018$size_mm, paired = FALSE)\nsize_test_non\n\n\n\n    Welch Two Sample t-test\n\ndata:  non_2012$size_mm and non_2018$size_mm\nt = 1.3343, df = 296.01, p-value = 0.1831\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -0.6196267  3.2289443\nsample estimates:\nmean of x mean of y \n 74.92462  73.61996 \n\nShow code\n\n# p = 0.18 ( p > 0.05)\n\n# ---------------\n# Effect size (3 and 4)\n# ---------------\n# MPA observations\nd_mpa <- effsize::cohen.d(mpa_2012$size_mm, mpa_2018$size_mm, na.rm = TRUE)\nd_mpa\n\n\n\nCohen's d\n\nd estimate: -0.8700026 (large)\n95 percent confidence interval:\n     lower      upper \n-1.2228615 -0.5171437 \n\nShow code\n\n# We have a large effect size for MPA lobster size in 2012 vs. 2018 (d > 0.8).\n\n# non-MPA observations\nd_non <- effsize::cohen.d(non_2012$size_mm, non_2018$size_mm, na.rm = TRUE)\nd_non\n\n\n\nCohen's d\n\nd estimate: 0.1213778 (negligible)\n95 percent confidence interval:\n      lower       upper \n-0.04070983  0.28346543 \n\nShow code\n\n# We have a negligible effect size for non-MPA lobster size between 2012 and 2018 (d < 0.2).\n\n# Difference between means of MPAs 2012 v. 2018 and non-MPAs 2012 v. 2018\ndifference_mpas <- mean_mpa_12 - mean_mpa_18\n\ndifference_non <- mean_non_12 - mean_non_18\n\n\n\n\n\nShow code\n\n# Now, we want to present this information in a table. We'll start by creating a new data frame with our summary statistics\n\nlobster_summary <- lobster_stats_df %>%\n  filter(year %in% c(2012,2018)) %>% \n  select(year, mpa, size_mm) %>% \n  group_by(year, mpa) %>% \n  summarise(sample_size = n(),\n            mean = mean(size_mm, na.rm = TRUE),\n            sd = sd(size_mm, na.rm = TRUE)) %>% \n  mutate_if(is.numeric, round, 1)\n\n# These calculations match my stored values, which indicates that I haven't made any mistakes here. Now, to create my Kable table.\n\nlobster_table <- lobster_summary %>% \n  kable(col.names = c(\"Sample year\",\n                      \"Protected status\",\n                      \"Sample size\",\n                      \"Mean lobster length (mm)\",\n                      \"Standard deviation\")) %>% \n  kable_styling(position = \"center\",\n                bootstrap_options = \"striped\", \"hover\",\n                full_width = F) \n\n\n\nFigure 5. Descriptive Statistics.\n\n\nShow code\n\nlobster_table\n\n\n\nSample year\n\n\nProtected status\n\n\nSample size\n\n\nMean lobster length (mm)\n\n\nStandard deviation\n\n\n2012\n\n\nmpa\n\n\n32\n\n\n67.4\n\n\n12.2\n\n\n2012\n\n\nnon-mpa\n\n\n199\n\n\n74.9\n\n\n12.4\n\n\n2018\n\n\nmpa\n\n\n1244\n\n\n77.6\n\n\n11.7\n\n\n2018\n\n\nnon-mpa\n\n\n561\n\n\n73.6\n\n\n10.1\n\n\nThe 2012 and 2018 sample sizes differed, with the 2012 sample being smaller than 2018 for both MPA and non-MPA sites (Figure 5). Because of this, we placed greater analytical value on the difference between the means and effect size to understand the impact of marine protected status on lobster size than the p value.\n\nMean lobster size between MPA and non-MPA sites in 2012.\nMean lobster size at MPAs was 7.5mm smaller than mean lobster size at non-MPA sites in 2012. Mean lobster size (mm) at MPA reefs (67.4 mm, SD = 12.15, n = 32) differed significantly from mean lobster size at non-MPA reefs (74.9 mm, SD = 12.41, n = 199) by a non-paired two-sample t-test (t(42.09) = 3.25, p < 0.025). There is a moderate effect size (d = 0.61) for lobster size in MPA vs. non-MPA reefs for 2012.\n\nMean lobster size between MPA and non-MPA sites in 2018.\nMean lobster size at MPAs was 3.9mm larger than mean lobster size at non-MPA sites in 2018. Mean lobster size (mm) at MPA reefs (77.6 mm, SD = 11.7, n = 1244) differed significantly from mean lobster size at non-MPA reefs (73.6 mm, SD = 10.09, n = 561) by a non-paired two-sample t-test (t(1239.51) = 7.31, p < 0.025). There is a small effect size (d = 0.35) for lobster size in MPA vs. non-MPA reefs for 2018.\n\nMean lobster size in MPA sites between 2012 and 2018.\nMean lobster size at MPA reefs was 10.2mm larger in 2018 than in 2012. Mean lobster size (mm) at MPA reefs in 2012 (67.4 mm, SD = 12.15, n = 32) differed significantly from mean lobster size at MPA reefs in 2018 (77.6 mm, SD = 11.7, n = 1244) by a non-paired two-sample t-test (t(32.5) = 4.69, p < 0.025). There is a large effect size (d = 0.87) for lobster size within MPA reefs in 2012 vs. 2018.\n\nMean lobster size in non-MPA sites between 2012 and 2018.\nMean lobster size at non-MPA reefs was 1.3mm smaller in 2018 than in 2012. Mean lobster size (mm) at non-MPA reefs in 2012 (74.9 mm, SD = 12.41, n = 199) did not differ significantly from mean lobster size at non-MPA reefs in 2018 (73.6 mm, SD = 10.09, n = 561) by a non-paired two-sample t-test (t(296.01) = 1.33, p > 0.025). There is a negligible effect size (d = 0.12) for lobster size within non-MPA reefs in 2012 vs. 2018.\n\nSUMMARY\nThe two MPA reefs (Naples and Isla Vista) showed an increase in both lobster abundance (Figure 3) and lobster community size structure distribution (Figure 4) between 2012 and 2018.\nThere was a statistically significant increase in mean lobster size (with a large effect size) within the MPA reefs in 2018 as compared to 2012. This demonstrates that closing these reefs to fishing had a positive effect on the Spiny lobster population size.\nSimilarly, in 2018 mean lobster size at MPA reefs was statistically significantly larger (although with a small effect size) than mean lobster size at non-MPA reefs in 2018.\nThere was no statistically significant difference found at non-MPA reefs when comparing lobster size between 2012 and 2018. This shows that keeping the reef open to fishing, or a “business-as-usual” scenario, did not effect lobster size.\n\nREFERENCES\nFrimodig, Adam, and Travis Buck. State of the California South Coast Supplemental Report: California Spiny Lobster. California Department of Fish and Wildlife, 2017, State of the California South Coast Supplemental Report: California Spiny Lobster.\nReed D. 2019. SBC LTER: Reef: Abundance, size and fishing effort for California Spiny Lobster (Panulirus interruptus), ongoing since 2012. Environmental Data Initiative. https://doi.org/10.6073/pasta/a593a675d644fdefb736750b291579a0. Dataset accessed 10/30/2019.\nSanta Barbara Coastal LTER, sbclter.msi.ucsb.edu/.\n\n\n\n",
    "preview": "posts/2021-03-14-lobster/lobster_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-03-15T00:06:19-07:00",
    "input_file": {}
  }
]
